### 2023 年 07/19(水)

## 勉強したこと(やったこと)

RSpec を使用した API テストとモデルテスト(Rails)

リクエストヘッダーに JWT を含め認証して送信する方法(React)

JWT の場合、rails でどんな json データが保存されているかの確認方法

rails s で直接ブラウザで確認すると認証されていないエラーが出るので、curl コマンドで確認すること(token 設定してポストマンでも可)

## わかったこと

jwt.io で確認して正確だった時の安心感。

ポストマンマジで便利！

JWT 認証を確認するときに痛感しました。curl コマンドでも確認できますがコマンドが長い！(JWT が長い)

認証できないなぁ〜と思ったら認証できていないのではなくリクエストヘッダーに JWT が含まれていないだけだったりするので、

開発者ツールでまずはリクエストヘッダーを確認することが大事です。それかコンソールで token を確認するのがわかりやすいです。

モデルテストの pending は保留中や未実装として扱われるので、削除すること！(気にしないでほっといたら常に pending になっていた)

## 次やること

バックエンド側のバリデーションとモデルテストを書く

テストでの検証の成功時と失敗時のテストを書く

コントローラー記述

ポストマンで api 確認

ポストマンで成功していて、front で失敗するときは、front 側の問題と特定できるので連携する前にポストマン確認大事！

front で api 連携してしっかりと保存できているか確認してみる

## 感じたこと

開発、テスト、本番この三つの環境は別々に管理することとしっかりと今からこの環境でやるよとパソコンに教えてあげること！

今までテストは行ってこなかったためテストの実行コマンドがうまく機能しなくてハマった。

JWT 検証ができなくてずっと 403Forbidden が出て苦労したが、スタブ化とモック化してあたかも認証が通ったかのようにする。

これで ok！(勿論、検証のテストとはならないので注意あくまでロジックのテストとルーティングのテストとなる)

## 勉強時間

Today: 10h

Total: 717h
