### 2023 年 08/02(水)

## 勉強したこと(やったこと)

今日は大ボスレシピ登録に成功しました！

ですがまだ改良の余地がありそうです。

## わかったこと

API で送るパラメータはしっかりと見ること、そのためポストマンで先に試すのが大事というのが今日実感しました！

パラメータが少しでもタイポするとすぐストパラエラーなどが出る

`JSON.stringify()`を使うと JSON 形式に変換できる

リクエストボディが front 側でどんな JSON 形式が送られているかを確認するのに使えそう！

`prev` の意味：前の状態の配列（prev）に新しい要素を追加して新しい配列を生成する

`スプレッド演算子`: これはよく使う技で既存の配列の要素をすべて新しい配列にコピーし、その後に新しい要素を追加するという操作が可能になる

UI で見てみると編集するときには、編集前の値が入っていて編集後は新しい値が入っていることができる

**より実践的なアプリの動きが開発できました！**

登録も一緒で登録すると API 叩かずに遷移せずに登録したレシピが表示されるようになる！

`some関数`: 配列内の少なくとも 1 つの要素が提供されたテスト関数を満たすかどうかをチェックするために使用される

真と評価される最初の要素に対して遭遇するとすぐに true を返す、もし全ての要素がテスト関数を満たさない場合、false を返す

```typescript
const handleAddIngredient = () => {
  if (
    !selectedIngredients.some((ingredient) => ingredient.ingredient.id === 0)
  ) {
    setSelectedIngredients((prev) => [...prev, initialIngredient]);
  } else {
    setWaringMessage("原材料を選択してから追加してください");
  }
};
```

これは原材料追加ボタンを押すと原材料が追加して選べるようになる関数なのですが

これを例として考えると、`some`関数は`selectedIngredients`の中に`ingredient.id`が 0 のものがあるかどうかをチェックしている

id0 = 初期値のダミーデータなので複数あると key が複数になってしまう為、削除等ができなくなるそれを回避するために`some`関数を使い

id0 が重複するときは`setWaringMessage`を表示するようにしている

## 次やること

レシピ登録の必要な検証を増やす

初期値のダミーデータが保存できてしまうので、それを回避するために検証を増やす(フロント側でやるべきか両方でやるべきか調査)

例えば、数量は負の数はダメとか、もちろん 0 もダメ、空欄もダメ

でもおかしい,rails でバリデーションをかけているので、なぜきかないのかを調べるのが良さそう。

仮説として Form オブジェクトを使っているから？

## 感じたこと

今日は大ボス、モデルが 3 つあるレシピ登録に成功しました！

これはでかい,あとは表示するだけ

## 勉強時間

Today: 8h

Total: 777h
